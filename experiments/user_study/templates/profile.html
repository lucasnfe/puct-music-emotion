<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/css/bootstrap-select.min.css">

    <!-- Local CSS -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">

    <!-- Load external libs -->
    <script src="{{ url_for('static', filename='js/lib/howler.js') }}"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.18/js/bootstrap-select.min.js"></script>

    <title>MCTS</title>
  </head>

  <body onload="main()">
      <div class="p-1"></div>

      <div class="card bg-white text-dark border rounded">
          <div class="card-header border-0 bg-primary"></div>

          <div class="card-body mx-2">
            <div id="header">
              <img src="http://{{ sever_name }}/static/imgs/uofa-logo.png" class="img-fluid" alt="Responsive image" width="30%">
              <h2 class="font-weight-normal">Controlling Perceived Emotions in Computer-Generated Music</h2>
            </div>
            <sup class="required">* Required</sup>
          </div>
      </div>

      <div class="p-1"></div>

      <div class="card bg-white border rounded">
          <div class="card-body mx-2">
            <small>
              <h6 id="piece-intro">Profile Questionnaire</h6>
              Please answer the questions below:
            </small>
          </div>
      </div>

      <div class="p-1"></div>

      <form id="profile-form" class="needs-validation" action="http://{{ sever_name }}/end" method="POST">
          <div class="card bg-white border rounded">
              <div class="card-body mx-2">
                <small>
                    <label for="ethnicity"><h6>Ethnicity: <sup class="required">*</sup></h6></label>
                    <select class="form-control dropdown" id="ethnicity" name="ethnicity" required>
                       <option value="" selected="selected" disabled="disabled">Choose...</option>
                       <option value="Asian">Asian</option>
                       <option value="Indian">American Indian or Alaska Native</option>
                       <option value="Black">Black or African American</option>
                       <option value="Hawaiian">Native Hawaiian or Other Pacific Islander</option>
                       <option value="White">White</option>
                       <option value="Other">Other</option>
                     </select>
                    <div class="col-2"></div>
                </small>

              </div>
          </div>

        <div class="p-1"></div>

          <div class="card bg-white border rounded">
              <div class="card-body mx-2">
                <small>
                    <label for="language"><h6>First Language: <sup class="required">*</sup></h6></label>
                    <select class="form-control dropdown" id="language" name="language" required>
                      <option value="" selected="selected" disabled="disabled">Choose...</option>
                      <option value="AF">Afrikaans</option>
                      <option value="SQ">Albanian</option>
                      <option value="AR">Arabic</option>
                      <option value="HY">Armenian</option>
                      <option value="EU">Basque</option>
                      <option value="BN">Bengali</option>
                      <option value="BG">Bulgarian</option>
                      <option value="CA">Catalan</option>
                      <option value="KM">Cambodian</option>
                      <option value="ZH">Chinese (Mandarin)</option>
                      <option value="HR">Croatian</option>
                      <option value="CS">Czech</option>
                      <option value="DA">Danish</option>
                      <option value="NL">Dutch</option>
                      <option value="EN">English</option>
                      <option value="ET">Estonian</option>
                      <option value="FJ">Fiji</option>
                      <option value="FI">Finnish</option>
                      <option value="FR">French</option>
                      <option value="KA">Georgian</option>
                      <option value="DE">German</option>
                      <option value="EL">Greek</option>
                      <option value="GU">Gujarati</option>
                      <option value="HE">Hebrew</option>
                      <option value="HI">Hindi</option>
                      <option value="HU">Hungarian</option>
                      <option value="IS">Icelandic</option>
                      <option value="ID">Indonesian</option>
                      <option value="GA">Irish</option>
                      <option value="IT">Italian</option>
                      <option value="JA">Japanese</option>
                      <option value="JW">Javanese</option>
                      <option value="KO">Korean</option>
                      <option value="LA">Latin</option>
                      <option value="LV">Latvian</option>
                      <option value="LT">Lithuanian</option>
                      <option value="MK">Macedonian</option>
                      <option value="MS">Malay</option>
                      <option value="ML">Malayalam</option>
                      <option value="MT">Maltese</option>
                      <option value="MI">Maori</option>
                      <option value="MR">Marathi</option>
                      <option value="MN">Mongolian</option>
                      <option value="NE">Nepali</option>
                      <option value="NO">Norwegian</option>
                      <option value="FA">Persian</option>
                      <option value="PL">Polish</option>
                      <option value="PT">Portuguese</option>
                      <option value="PA">Punjabi</option>
                      <option value="QU">Quechua</option>
                      <option value="RO">Romanian</option>
                      <option value="RU">Russian</option>
                      <option value="SM">Samoan</option>
                      <option value="SR">Serbian</option>
                      <option value="SK">Slovak</option>
                      <option value="SL">Slovenian</option>
                      <option value="ES">Spanish</option>
                      <option value="SW">Swahili</option>
                      <option value="SV">Swedish </option>
                      <option value="TA">Tamil</option>
                      <option value="TT">Tatar</option>
                      <option value="TE">Telugu</option>
                      <option value="TH">Thai</option>
                      <option value="BO">Tibetan</option>
                      <option value="TO">Tonga</option>
                      <option value="TR">Turkish</option>
                      <option value="UK">Ukrainian</option>
                      <option value="UR">Urdu</option>
                      <option value="UZ">Uzbek</option>
                      <option value="VI">Vietnamese</option>
                      <option value="CY">Welsh</option>
                      <option value="XH">Xhosa</option>
                      <option value="Other">Other</option>
                    </select>
                    <div class="col-2"></div>
                </small>
              </div>
          </div>

          <div class="p-1"></div>

          <div class="card bg-white border rounded">
              <div class="card-body mx-2">
                <small>
                    <label for="year"><h6>Birth Year: <sup class="required">*</sup></h6></label>
                    <select class="form-control dropdown" id="year" name="year" required>
                      <option value="" selected="selected" disabled="disabled">Choose...</option>
                        <option value="2004">2004</option>
                        <option value="2003">2003</option>
                        <option value="2002">2002</option>
                        <option value="2001">2001</option>
                        <option value="2000">2000</option>
                        <option value="1999">1999</option>
                        <option value="1998">1998</option>
                        <option value="1997">1997</option>
                        <option value="1996">1996</option>
                        <option value="1995">1995</option>
                        <option value="1994">1994</option>
                        <option value="1993">1993</option>
                        <option value="1992">1992</option>
                        <option value="1991">1991</option>
                        <option value="1990">1990</option>
                        <option value="1989">1989</option>
                        <option value="1988">1988</option>
                        <option value="1987">1987</option>
                        <option value="1986">1986</option>
                        <option value="1985">1985</option>
                        <option value="1984">1984</option>
                        <option value="1983">1983</option>
                        <option value="1982">1982</option>
                        <option value="1981">1981</option>
                        <option value="1980">1980</option>
                        <option value="1979">1979</option>
                        <option value="1978">1978</option>
                        <option value="1977">1977</option>
                        <option value="1976">1976</option>
                        <option value="1975">1975</option>
                        <option value="1974">1974</option>
                        <option value="1973">1973</option>
                        <option value="1972">1972</option>
                        <option value="1971">1971</option>
                        <option value="1970">1970</option>
                        <option value="1969">1969</option>
                        <option value="1968">1968</option>
                        <option value="1967">1967</option>
                        <option value="1966">1966</option>
                        <option value="1965">1965</option>
                        <option value="1964">1964</option>
                        <option value="1963">1963</option>
                        <option value="1962">1962</option>
                        <option value="1961">1961</option>
                        <option value="1960">1960</option>
                        <option value="1959">1959</option>
                        <option value="1958">1958</option>
                        <option value="1957">1957</option>
                        <option value="1956">1956</option>
                        <option value="1955">1955</option>
                        <option value="1954">1954</option>
                        <option value="1953">1953</option>
                        <option value="1952">1952</option>
                        <option value="1951">1951</option>
                        <option value="1950">1950</option>
                        <option value="1949">1949</option>
                        <option value="1948">1948</option>
                        <option value="1947">1947</option>
                        <option value="1946">1946</option>
                        <option value="1945">1945</option>
                        <option value="1944">1944</option>
                        <option value="1943">1943</option>
                        <option value="1942">1942</option>
                        <option value="1941">1941</option>
                        <option value="1940">1940</option>
                        <option value="1939">1939</option>
                        <option value="1938">1938</option>
                        <option value="1937">1937</option>
                        <option value="1936">1936</option>
                        <option value="1935">1935</option>
                        <option value="1934">1934</option>
                        <option value="1933">1933</option>
                        <option value="1932">1932</option>
                        <option value="1931">1931</option>
                        <option value="1930">1930</option>
                        <option value="1929">1929</option>
                        <option value="1928">1928</option>
                        <option value="1927">1927</option>
                        <option value="1926">1926</option>
                        <option value="1925">1925</option>
                        <option value="1924">1924</option>
                        <option value="1923">1923</option>
                        <option value="1922">1922</option>
                        <option value="1921">1921</option>
                        <option value="1920">1920</option>
                        <option value="1919">1919</option>
                        <option value="1918">1918</option>
                        <option value="1917">1917</option>
                        <option value="1916">1916</option>
                        <option value="1915">1915</option>
                        <option value="1914">1914</option>
                        <option value="1913">1913</option>
                        <option value="1912">1912</option>
                        <option value="1911">1911</option>
                        <option value="1910">1910</option>
                        <option value="1909">1909</option>
                        <option value="1908">1908</option>
                        <option value="1907">1907</option>
                        <option value="1906">1906</option>
                        <option value="1905">1905</option>
                    </select>

                    <div class="col-2"></div>
                </small>
              </div>
          </div>

          <div class="p-1"></div>

          <div class="card bg-white border rounded">
              <div class="card-body mx-2">
                <small>
                    <label for="gender"><h6>Gender: <sup class="required">*</sup></h6></label>
                    <select class="form-control dropdown" id="gender" name="gender" required>
                      <option value="" selected="selected" disabled="disabled">Choose...</option>
                      <option value="Female">I identify myself as Female</option>
                      <option value="Male">I identify myself as Male</option>
                      <option value="NonBinary">I identify myself as Non-binary</option>
                      <option value="Other">Other</option>
                    </select>

                    <div class="col-2"></div>
                </small>
              </div>
          </div>

          <div class="p-1"></div>

          <div class="card bg-white border rounded">
              <div class="card-body mx-2">
                <small>
                    <label for="xp"><h6>Highest Level of Formal Music Training:<sup class="required">*</sup></h6></label>
                    <div class="btn-toolbar d-flex justify-content-center" role="toolbar" >
                      <div class="btn-group" role="group" >
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="xp" id="music-exp-1" value="1" required>
                          <label class="form-check-label" for="inlineRadio1">None</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="xp" id="music-exp-2" value="2" required>
                          <label class="form-check-label" for="inlineRadio2">Primary</br>(Elementary school level)</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="xp" id="music-exp-3" value="3" required>
                          <label class="form-check-label" for="inlineRadio3">Secondary</br>(High school level)</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="xp" id="music-exp-4" value="4" required>
                          <label class="form-check-label" for="inlineRadio3">Tertiary</br>(Undergraduate level)</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="xp" id="music-exp-5" value="5" required>
                          <label class="form-check-label" for="inlineRadio3">Post-graduate</label>
                        </div>
                      </div>
                    </div>

                    <div class="col-2"></div>
                </small>
              </div>
          </div>

          <div class="p-1"></div>

          <div class="card bg-white border rounded">
              <div class="card-body mx-2">
                <small>
                    <label for="comments"><h6>Please let us know if you have any comments about our experiment.</h6></label>
                    <input type="text" class="form-control" placeholder="Your Answer..." name="comments" id="comments">

                    <div class="col-2"></div>
                </small>
              </div>
          </div>

          <div class="row align-items-center mt-2 mb-2">
            <div class="col-4">
                <button id="prevButton" type="button" class="btn-page btn border rounded bg-white" onclick="">Back</button>
                <button id="nextButton" type="submit" class="btn-page btn border bg-white rounded">Submit</button>
            </div>

            <div class="col">
                <div class="row align-items-center justify-content-end">
                    <div class="col">
                        <div id="ppage-back" class="progress bg-secondary" style="height: 10px;">
                          <div id="ppage" class="progress-bar" role="progressbar"></div>
                        </div>
                   </div>

                   <div class="col-6">
                        <label id="npage">Page I of N</label>
                    </div>
                </div>
            </div>
          </div>
      </form>

      <div class="p-4"></div>
  </body>

  <script>
    function main() {
        // Check if study has already been taken
        let evaluationId = localStorage.getItem("evaluation_id");

        if (evaluationId) {
          window.location.href = "http://{{ sever_name }}/end";
          return;
        }

        let experiment = localStorage.getItem("experiment");
        let order = localStorage.getItem("order").split(',');

        // Compute paging
        let npage = document.getElementById("npage");
        npage.innerHTML = npage.innerHTML.replace("I", order.length + 2);
        npage.innerHTML = npage.innerHTML.replace("N", order.length + 2);

        let ppage = document.getElementById("ppage");
        ppage.style.width = "100%";

        // Retrieve current piece index
        let pieceIndex = parseInt(localStorage.getItem("piece_index"));

        // Define form action
        let prevButton = document.getElementById('prevButton');

        prevButton.onclick = function() {
          localStorage.setItem("piece_index", pieceIndex - 1);
          window.location.href = 'http://{{ sever_name }}/evaluate/' + experiment + '/' + order[pieceIndex - 1];
        }

        $('#profile-form').append('<input type="hidden" name="' + "experiment" + '" value="' + experiment + '" />');
        for (let piece of order) {
            let question1Answer = localStorage.getItem(piece + "_q1");
            $('#profile-form').append('<input type="hidden" name="' + piece + "_q1" + '" value="' + question1Answer + '" />');

            let question2Answer = localStorage.getItem(piece + "_q2");
            $('#profile-form').append('<input type="hidden" name="' + piece + "_q2" + '" value="' + question2Answer + '" />');

            let question3Answer = localStorage.getItem(piece + "_q3");
            $('#profile-form').append('<input type="hidden" name="' + piece + "_q3" + '" value="' + question3Answer + '" />');

            let question4Answer = localStorage.getItem(piece + "_q4");
            $('#profile-form').append('<input type="hidden" name="' + piece + "_q4" + '" value="' + question4Answer + '" />');

            let question5Answer = localStorage.getItem(piece + "_q5");
            $('#profile-form').append('<input type="hidden" name="' + piece + "_q5" + '" value="' + question5Answer + '" />');
        }
    }
  </script>
</html>
